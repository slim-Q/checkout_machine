# checkout_machine
实现一个收银机打印模块

### 文件说明
main.lua是主程序文件，模块输入json在该文件JSON_TEXT中定义.

function.lua是函数库文件.

config.lua是配置文件，包含了商品明细信息和商品优惠配置.
### 编写环境
	Red Hat Enterprise Linux Server release 6.2 (Santiago)
	Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
### 详细配置
	--商品优惠信息配置
	sales = {
		down = { goods = {  }, value = 3 }, --down满减活动 goods为参与活动的商品ID，valu
e为3表示满三减一即满二赠一
		discounts = { goods = { "ITEM000003" }, value = 0.95 } --discounts打折活动，good
s为参与活动的商品ID，value为0.95表示九五折
	}
	--商品信息
	--key是商品ID，值是商品名称、计价单位、单价、分类
	goods_list = {
		ITEM000005={ name="可口可乐",unit="瓶",price=3.00,group="饮料"},
		ITEM000003={ name="苹果",unit="斤",price=5.50,group="水果"},
		ITEM000001={ name="羽毛球",unit="个",price=1.00,group="日用"}
	}
### 测试
1. 没有优惠
配置
	sales = {
		down = { goods = { }, value = 3 }, 
		discounts = { goods = { }, value = 0.95 } 
	}
输出
***<没钱赚商店>购物清单***
名称：可口可乐 数量：3瓶 单价：3.00(元) 小计：9.00(元)
名称：羽毛球 数量：5个 单价：1.00(元) 小计：5.00(元)
名称：苹果 数量：2斤 单价：5.50(元) 小计：11.00(元)
----------------------
总计：	25.00(元)
节省：	0.00(元)
**********************
2. 九五折优惠
配置
	sales = {
		down = { goods = { }, value = 3 }, 
		discounts = { goods = { "ITEM000003" }, value = 0.95 } 
	}
输出
***<没钱赚商店>购物清单***
名称：可口可乐 数量：3瓶 单价：3.00(元) 小计：9.00(元)
名称：羽毛球 数量：5个 单价：1.00(元) 小计：5.00(元)
名称：苹果数量：2斤 单价：5.50(元) 小计：10.45(元) 节省：0.55(元)
----------------------
总计：	24.45(元)
节省：	0.55(元)
********************** 
3. 满二赠一活动
配置
	sales = {
		down = { goods = { "ITEM000005", "ITEM000001" }, value = 3 },
		discounts = { goods = { }, value = 0.95 } 
	}
输出
***<没钱赚商店>购物清单***
名称：可口可乐 数量：3瓶 单价：3.00(元) 小计：6.00(元)
名称：羽毛球 数量：5个 单价：1.00(元) 小计：4.00(元)
名称：苹果 数量：2斤 单价：5.50(元) 小计：11.00(元)
----------------------
买二赠一商品：
名称：	羽毛球	数量：	1个
名称：	可口可乐	数量：	1瓶
----------------------
总计：	21.00(元)
节省：	4.00(元)
**********************
4. 可口可乐同时享有满二赠一和九五折优惠
配置
	sales = {
		down = { goods = { "ITEM000005", "ITEM000001" }, value = 3 },
		discounts = { goods = { "ITEM000005", "ITEM000003" }, value = 0.95 } 
	}
输出
***<没钱赚商店>购物清单***
名称：可口可乐 数量：3瓶 单价：3.00(元) 小计：6.00(元)
名称：羽毛球 数量：5个 单价：1.00(元) 小计：4.00(元)
名称：苹果数量：2斤 单价：5.50(元) 小计：10.45(元) 节省：0.55(元)
----------------------
买二赠一商品：
名称：	羽毛球	数量：	1个
名称：	可口可乐	数量：	1瓶
----------------------
总计：	20.45(元)
节省：	4.55(元)
**********************
### 附
解析json使用了lua-cjson库.

  地址https://github.com/mpx/lua-cjson.git .

在此感谢.
